# Internationalization (i18n) for AI Providers

This document explains what translations providers must register.

## Required: History Label

Every provider must register a history label. This is shown in the asset library for generated items.

```typescript
import { getPanelId } from '@imgly/plugin-ai-generation-web';

export function MyProvider(config: ProviderConfiguration) {
  return async ({ cesdk }) => {
    const modelKey = 'partner/vendor/model-name';

    cesdk.i18n.setTranslations({
      en: {
        [`libraries.${getPanelId(modelKey)}.history.label`]: 'Generated Images'
      }
    });

    return createImageProvider({ modelKey, ... }, config);
  };
}
```

Use `getPanelId(modelKey)` to generate the panel ID (converts `partner/vendor/model` to `ly_img_ai_partner_vendor_model`).

### History Label by Provider Type

| Provider Type | History Label |
|---------------|---------------|
| Text-to-Image | `'Generated From Text'` |
| Image-to-Image | `'Generated From Image'` |
| Text-to-Video | `'Generated Videos'` |
| Image-to-Video | `'Generated From Image'` |

## Custom Enum Values (Style, etc.)

If your provider has custom enum values not covered by defaults, register translations for them.

**Default translations already exist for:** common aspect ratios (`1:1`, `16:9`, `9:16`, etc.), resolutions (`720p`, `1080p`), and standard properties. See `packages/plugin-ai-generation-web/src/openapi/defaultTranslations.ts` for the full list.

**You only need to register** provider-specific values like custom styles:

```typescript
const STYLES = [
  { id: 'realistic', label: 'Realistic' },
  { id: 'anime', label: 'Anime Style' },
  { id: 'digital_art', label: 'Digital Art' }
];

// Build translations
const styleTranslations: Record<string, string> = {};
STYLES.forEach(({ id, label }) => {
  styleTranslations[
    `ly.img.plugin-ai-image-generation-web.${modelKey}.property.style.${id}`
  ] = label;
});

cesdk.i18n.setTranslations({
  en: {
    [`libraries.${getPanelId(modelKey)}.history.label`]: 'Generated Images',
    ...styleTranslations
  }
});
```

### Alternative: Schema Labels

Enum labels can also be defined in the JSON schema using `x-imgly-enum-labels`:

```json
{
  "style": {
    "type": "string",
    "enum": ["realistic", "anime", "digital_art"],
    "x-imgly-enum-labels": {
      "realistic": "Realistic",
      "anime": "Anime Style",
      "digital_art": "Digital Art"
    }
  }
}
```

The system extracts these automatically. Use `cesdk.i18n.setTranslations()` when you need runtime-determined labels or custom property renderers.

## Adding Default Translations

If your provider uses common enum values that other providers might also use, add them to the defaults file instead:

**File:** `packages/plugin-ai-generation-web/src/openapi/defaultTranslations.ts`

```typescript
export const defaultTranslations: Record<string, string> = {
  // ... existing defaults ...

  // Add new common values here
  'ly.img.plugin-ai-generation-web.defaults.property.aspect_ratio.21:9': '21:9 (Ultrawide)',
};
```

This makes the translation available to all providers automatically.

## Integrator Translation Customization

Integrators can customize translations (e.g., to rebrand "Generate Image" to their own label) in two ways:

### Option 1: Set Translations BEFORE Adding Plugins (Recommended)

The AI plugins use `setDefaultTranslations()` internally, which only sets translations for keys that don't already exist. This means integrators can set their custom translations **before** loading the plugins:

```typescript
// 1. Create the editor
const cesdk = await CreativeEditorSDK.create(container, { ... });

// 2. Set custom translations BEFORE adding plugins
// These will NOT be overwritten by plugin defaults
cesdk.setTranslations({
  en: {
    '@imgly/plugin-ai-image-generation-web.action.label': 'Create AI Image',
    'panel.ly.img.ai.image-generation': 'AI Image Creator',
    'ly.img.plugin-ai-generation-web.generate': 'Create'
  }
});

// 3. Add AI plugins - your translations are preserved!
await cesdk.addPlugin(AiApps({ ... }));
```

This approach is simpler and more intuitive - you set your customizations once, and they're respected.

### Option 2: Set Translations AFTER Adding Plugins

Alternatively, you can override translations after plugins are loaded:

```typescript
// 1. Create the editor
const cesdk = await CreativeEditorSDK.create(container, { ... });

// 2. Add AI plugins - MUST use await!
await cesdk.addPlugin(AiApps({ ... }));

// 3. AFTER plugins are fully loaded, override translations
cesdk.setTranslations({
  en: {
    '@imgly/plugin-ai-image-generation-web.action.label': 'Create AI Image',
    'panel.ly.img.ai.image-generation': 'AI Image Creator',
    'ly.img.plugin-ai-generation-web.generate': 'Create'
  }
});
```

**Important:** You **must `await`** the `addPlugin()` call if using this approach.

### Action Label Keys

Each plugin registers an action label that appears in the AI Apps panel:

| Plugin | Translation Key | Default Value |
|--------|-----------------|---------------|
| Image Generation | `@imgly/plugin-ai-image-generation-web.action.label` | `'Generate Image'` |
| Video Generation | `@imgly/plugin-ai-video-generation-web.action.label` | `'Generate Video'` |
| Sticker Generation | `@imgly/plugin-ai-sticker-generation-web.action.label` | `'Generate Sticker'` |
| Audio (Sound) | `@imgly/plugin-ai-audio-generation-web.sound.action.label` | `'Generate Sound'` |
| Audio (Speech) | `@imgly/plugin-ai-audio-generation-web.speech.action.label` | `'AI Voice'` |

### Testing Translations

The AI demo app supports a `?translations=true` query parameter that applies test prefixes to all translations:
- `&` prefix for generic translations (e.g., `&Generate Image`)
- `@` prefix for provider-specific translations (e.g., `@Realistic Image`)

This helps verify that all labels can be customized via `setTranslations()`.

## Checklist

- [ ] History label registered (`libraries.{panelId}.history.label`)
- [ ] Custom enum values translated (if not using schema labels)
- [ ] Common values added to `defaultTranslations.ts` (if reusable across providers)
- [ ] Integrator translations applied **after** `addPlugin()` completes
